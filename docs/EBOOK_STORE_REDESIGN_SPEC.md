# E-book Store é‡æ„è®¾è®¡æ–‡æ¡£

## æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿° E-book Store é¡µé¢çš„é‡æ„è®¾è®¡ï¼ŒåŒ…å«å‰ç«¯å¸ƒå±€ã€API è®¾è®¡å’Œæ•°æ®æ¨¡å‹å˜æ›´ã€‚

**è®¾è®¡ç¨¿å‚è€ƒ**: `/Users/HONGBGU/Desktop/BookLibrio/stitch_e_book_store_home_page/`

---

## 1. é¡µé¢æ•´ä½“å¸ƒå±€

### æ–°å¸ƒå±€ç»“æ„ï¼ˆä»ä¸Šåˆ°ä¸‹ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Search Bar (æœç´¢æ )                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Tab Picker [E-books] [Magazines]            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Â§ Recommended for You (æ¨ªå‘æ»šåŠ¨ä¹¦ç±å¡ç‰‡)      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Â§ Categories (æ¨ªå‘æ»šåŠ¨ï¼ŒåŠ¨æ€åˆ†ç±»)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Â§ Books by Year (æŒ‰å‡ºç‰ˆå¹´ä»½åˆ†ç»„)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Â§ Top Rated (é«˜è¯„åˆ†ä¹¦ç±åˆ—è¡¨)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Â§ Curated Collections (ç²¾é€‰åˆé›†)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Â§ External Rankings (å¤–éƒ¨æ’è¡Œæ¦œ)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸å½“å‰å®ç°å¯¹æ¯”

| å½“å‰å®ç° | æ–°è®¾è®¡ | å˜æ›´è¯´æ˜ |
|---------|--------|---------|
| Tab åœ¨æœç´¢æ ä¸Šæ–¹ | Tab åœ¨æœç´¢æ ä¸‹æ–¹ | ä½ç½®è°ƒæ•´ |
| Categories 4åˆ—ç½‘æ ¼ | Categories æ¨ªå‘æ»šåŠ¨ | å¸ƒå±€å˜æ›´ |
| æ—  | Books by Year | æ–°å¢ |
| æ’è¡Œæ¦œé¢„è§ˆ | Top Rated | æ ·å¼é‡æ„ |
| çƒ­é—¨ä¹¦å• | Curated Collections | æ ·å¼ä¼˜åŒ– |
| æ—  | External Rankings | æ–°å¢ |

---

## 2. å„åŒºå—è¯¦ç»†è®¾è®¡

### 2.1 Search Bar (æœç´¢æ )

**ä½ç½®å˜æ›´**: ä» Tab ä¸‹æ–¹ç§»è‡³ Tab ä¸Šæ–¹

**UI è§„æ ¼**:
- å ä½ç¬¦: "Search for books or magazines" (æ ¹æ® Tab åŠ¨æ€åˆ‡æ¢)
- èƒŒæ™¯: `Color(.systemGray6)`
- åœ†è§’: 10pt
- å†…è¾¹è·: 12pt

**æ— éœ€åç«¯å˜æ›´**

---

### 2.2 Recommended for You (ä¸ºä½ æ¨è)

**å˜æ›´**: ä» TabView è½®æ’­æ”¹ä¸ºæ¨ªå‘æ»šåŠ¨å¡ç‰‡

**UI è§„æ ¼**:
```
+------------------+  +------------------+  +------------------+
|   [Book Cover]   |  |   [Book Cover]   |  |   [Book Cover]   |
|     100x140      |  |     100x140      |  |     100x140      |
+------------------+  +------------------+  +------------------+
|   Book Title     |  |   Book Title     |  |   Book Title     |
|   Author Name    |  |   Author Name    |  |   Author Name    |
+------------------+  +------------------+  +------------------+
```

**å¡ç‰‡å°ºå¯¸**:
- å°é¢: 100 x 140 pt
- å¡ç‰‡å®½åº¦: 100 pt
- å¡ç‰‡é—´è·: 12 pt

**API**: å¤ç”¨ç°æœ‰ `GET /api/ebooks?limit=10` æˆ– `GET /api/rankings/trending`

**æ— éœ€åç«¯å˜æ›´**

---

### 2.3 Categories (åˆ†ç±») âš ï¸ éœ€è¦å‰ç«¯æ”¹åŠ¨

**å˜æ›´**: ä» 4 åˆ—ç½‘æ ¼æ”¹ä¸ºæ¨ªå‘æ»šåŠ¨

**UI è§„æ ¼**:
```
æ¨ªå‘æ»šåŠ¨ï¼š
[History] [Literature] [Fiction] [Technology] [Science] [Art] ...

å•ä¸ªåˆ†ç±» Cell:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    [Icon]     â”‚   å›¾æ ‡: 40pt åœ†å½¢èƒŒæ™¯
â”‚   History     â”‚   æ–‡å­—: Caption, Medium
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Cell å®½åº¦: 70pt
Cell é—´è·: 12pt
```

**æ˜¾ç¤ºè§„åˆ™**:
- æ˜¾ç¤ºæ‰€æœ‰åˆ†ç±»ï¼ˆä¸å†é™åˆ¶ 8 ä¸ªï¼‰
- æ¨ªå‘æ»šåŠ¨ï¼Œå¯æ»‘åŠ¨æŸ¥çœ‹æ›´å¤š
- ç‚¹å‡»è¿›å…¥åˆ†ç±»è¯¦æƒ…é¡µ

**API**: å¤ç”¨ç°æœ‰ `GET /api/categories?bookType=ebook&flat=false`

**æ— éœ€åç«¯å˜æ›´**

---

### 2.4 Books by Year (æŒ‰å¹´ä»½åˆ†ç±») ğŸ”´ éœ€è¦åç«¯æ”¯æŒ

**åŠŸèƒ½è¯´æ˜**: å±•ç¤ºæŒ‰å‡ºç‰ˆå¹´ä»½åˆ†ç»„çš„ä¹¦ç±

**UI è§„æ ¼**:
```
Â§ Books by Year                        [View More >]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚ â”‚  Cover   â”‚  â”‚  Cover   â”‚  â”‚  Cover   â”‚           â”‚
â”‚ â”‚  80x110  â”‚  â”‚  80x110  â”‚  â”‚  80x110  â”‚  â†’        â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
â”‚ â”‚The Wager â”‚  â”‚Tomorrow..|  â”‚Lessons.. â”‚           â”‚
â”‚ â”‚   2023   â”‚  â”‚   2022   â”‚  â”‚   2022   â”‚           â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¡ç‰‡è§„æ ¼**:
- å°é¢: 80 x 110 pt
- ä¹¦å: Caption, Medium, æœ€å¤š 2 è¡Œ
- å¹´ä»½æ ‡ç­¾: Caption2, Secondary color, ç°è‰²èƒŒæ™¯åœ†è§’æ ‡ç­¾

**æ–°å¢ API**:

```
GET /api/store/books-by-year
```

**Request Parameters**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| bookType | string | æ˜¯ | "ebook" æˆ– "magazine" |
| limit | number | å¦ | æ¯å¹´è¿”å›ä¹¦ç±æ•°é‡ï¼Œé»˜è®¤ 10 |
| years | string | å¦ | æŒ‡å®šå¹´ä»½ï¼Œé€—å·åˆ†éš”ï¼Œå¦‚ "2024,2023,2022"ï¼Œé»˜è®¤æœ€è¿‘ 3 å¹´ |

**Response**:
```json
{
  "data": [
    {
      "year": 2024,
      "books": [
        {
          "id": 123,
          "title": "Book Title",
          "author": "Author Name",
          "coverUrl": "https://...",
          "publicationDate": "2024-03-15",
          "rating": 4.5,
          "ratingCount": 128
        }
      ]
    },
    {
      "year": 2023,
      "books": [...]
    }
  ]
}
```

**æ•°æ®åº“å˜æ›´**:
- ç¡®ä¿ `ebooks` è¡¨çš„ `publicationDate` å­—æ®µå·²å¡«å……
- å¯èƒ½éœ€è¦æ‰¹é‡æ›´æ–°ç°æœ‰ä¹¦ç±çš„å‡ºç‰ˆæ—¥æœŸ

---

### 2.5 Top Rated (é«˜è¯„åˆ†ä¹¦ç±) ğŸ”´ éœ€è¦åç«¯æ”¯æŒ

**åŠŸèƒ½è¯´æ˜**: å±•ç¤ºè¯„åˆ†æœ€é«˜çš„ä¹¦ç±åˆ—è¡¨

**UI è§„æ ¼**:
```
Â§ Top Rated                            [View More >]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Cover  â”‚  Project Hail Mary                   â”‚  â”‚
â”‚ â”‚ 60x80  â”‚  Andy Weir                           â”‚  â”‚
â”‚ â”‚        â”‚  â˜…â˜…â˜…â˜…â˜…  4.8 (2,341)                â”‚  â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚ â”‚ Cover  â”‚  Pachinko                            â”‚  â”‚
â”‚ â”‚ 60x80  â”‚  Min Jin Lee                         â”‚  â”‚
â”‚ â”‚        â”‚  â˜…â˜…â˜…â˜…â˜†  4.5 (1,892)                â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åˆ—è¡¨é¡¹è§„æ ¼**:
- å°é¢: 60 x 80 pt
- ä¹¦å: Subheadline, Bold
- ä½œè€…: Caption, Secondary color
- è¯„åˆ†: æ˜Ÿçº§å›¾æ ‡ (æ©™è‰²) + æ•°å­—è¯„åˆ† + è¯„åˆ†äººæ•°

**API æ–¹æ¡ˆ**:

**æ–¹æ¡ˆ A**: å¤ç”¨ç°æœ‰ Rankings API
```
GET /api/rankings/top_rated?limit=10
```
éœ€è¦ç¡®ä¿è¿”å›æ•°æ®åŒ…å« `rating` å’Œ `ratingCount` å­—æ®µã€‚

**æ–¹æ¡ˆ B**: æ–°å¢ä¸“ç”¨ API (æ¨è)
```
GET /api/store/top-rated
```

**Request Parameters**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| bookType | string | æ˜¯ | "ebook" æˆ– "magazine" |
| limit | number | å¦ | è¿”å›æ•°é‡ï¼Œé»˜è®¤ 10 |
| minRatingCount | number | å¦ | æœ€å°è¯„åˆ†äººæ•°ç­›é€‰ï¼Œé»˜è®¤ 10 |

**Response**:
```json
{
  "data": [
    {
      "id": 456,
      "title": "Project Hail Mary",
      "author": "Andy Weir",
      "coverUrl": "https://...",
      "rating": 4.8,
      "ratingCount": 2341,
      "externalRatingSource": "goodreads"
    }
  ],
  "total": 100
}
```

**æ•°æ®åº“è€ƒè™‘**:
- ä½¿ç”¨ `ebooks.externalRating` å’Œ `ebooks.externalRatingCount` å­—æ®µ
- æ’åº: `ORDER BY externalRating DESC, externalRatingCount DESC`
- ç­›é€‰: `WHERE externalRatingCount >= minRatingCount`

---

### 2.6 Curated Collections (ç²¾é€‰åˆé›†) ğŸŸ¡ éœ€è¦åç«¯ä¼˜åŒ–

**åŠŸèƒ½è¯´æ˜**: å±•ç¤ºç¼–è¾‘ç²¾é€‰çš„ä¸»é¢˜ä¹¦å•

**UI è§„æ ¼**:
```
Â§ Curated Collections                   [View More >]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚ â”‚ [Background Img]â”‚  â”‚ [Background Img]â”‚           â”‚
â”‚ â”‚                 â”‚  â”‚                 â”‚           â”‚
â”‚ â”‚ Classic         â”‚  â”‚ Bill Gates'     â”‚  â†’        â”‚
â”‚ â”‚ Literature      â”‚  â”‚ Choice          â”‚           â”‚
â”‚ â”‚ ğŸ“š 12 books     â”‚  â”‚ ğŸ“š 8 books      â”‚           â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¡ç‰‡è§„æ ¼**:
- å¡ç‰‡å°ºå¯¸: 160 x 120 pt
- èƒŒæ™¯: æ¸å˜è‰²æˆ–ä¸»é¢˜å›¾ç‰‡
- æ ‡é¢˜: Subheadline, Bold, ç™½è‰²
- ä¹¦ç±æ•°é‡: Caption, ç™½è‰²åŠé€æ˜

**API ä¼˜åŒ–**:

å¤ç”¨ç°æœ‰ `GET /api/book-lists` å¹¶å¢åŠ å­—æ®µ:

```
GET /api/book-lists?featured=true&limit=6
```

**éœ€è¦å¢å¼ºçš„ Response å­—æ®µ**:
```json
{
  "data": [
    {
      "id": 1,
      "title": "Classic Literature",
      "description": "Timeless literary masterpieces",
      "coverUrl": "https://...",
      "backgroundUrl": "https://...",       // æ–°å¢: èƒŒæ™¯å›¾
      "themeColor": "#6B4FA2",              // æ–°å¢: ä¸»é¢˜è‰²
      "bookCount": 12,
      "previewCovers": [                    // æ–°å¢: å‰3æœ¬ä¹¦å°é¢é¢„è§ˆ
        "https://cover1.jpg",
        "https://cover2.jpg",
        "https://cover3.jpg"
      ],
      "creator": {
        "id": 1,
        "username": "editor",
        "avatar": "..."
      }
    }
  ]
}
```

**æ•°æ®åº“å˜æ›´**:
```sql
ALTER TABLE book_lists ADD COLUMN background_url TEXT;
ALTER TABLE book_lists ADD COLUMN theme_color VARCHAR(20);
```

---

### 2.7 External Rankings (å¤–éƒ¨æ’è¡Œæ¦œ) ğŸ”´ éœ€è¦åç«¯æ”¯æŒ

**åŠŸèƒ½è¯´æ˜**: å±•ç¤ºæ¥è‡ªå¤–éƒ¨æ¥æºçš„æƒå¨ä¹¦ç±æ’è¡Œæ¦œ

**UI è§„æ ¼**:
```
Â§ External Rankings & Recommended Lists   [View More >]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚ â”‚ [amazon logo]   â”‚  â”‚ [NYT logo]      â”‚           â”‚
â”‚ â”‚                 â”‚  â”‚                 â”‚           â”‚
â”‚ â”‚ Amazon Annual   â”‚  â”‚ New York Times  â”‚  â†’        â”‚
â”‚ â”‚ Bestsellers     â”‚  â”‚ Bestseller List â”‚           â”‚
â”‚ â”‚                 â”‚  â”‚                 â”‚           â”‚
â”‚ â”‚ Top Selling...  â”‚  â”‚ Top Fiction &.. â”‚           â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¡ç‰‡è§„æ ¼**:
- å¡ç‰‡å°ºå¯¸: 160 x 140 pt
- Logo: 40 x 40 pt
- æ ‡é¢˜: Subheadline, Bold
- æè¿°: Caption, Secondary color

**æ–°å¢ API**:

```
GET /api/store/external-rankings
```

**Request Parameters**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| bookType | string | å¦ | "ebook" æˆ– "magazine"ï¼Œé»˜è®¤ "ebook" |

**Response**:
```json
{
  "data": [
    {
      "id": "amazon-bestsellers-2024",
      "source": "amazon",
      "sourceName": "Amazon",
      "sourceLogoUrl": "https://...",
      "title": "Amazon Annual Bestsellers",
      "subtitle": "Top Selling Books of 2024",
      "description": "The most purchased books on Amazon this year",
      "bookCount": 100,
      "lastUpdated": "2024-12-01T00:00:00Z",
      "url": "https://amazon.com/bestsellers"
    },
    {
      "id": "nyt-fiction-2024",
      "source": "nyt",
      "sourceName": "New York Times",
      "sourceLogoUrl": "https://...",
      "title": "NYT Bestseller List",
      "subtitle": "Top Fiction & Non-Fiction",
      "description": "Weekly updated bestseller rankings",
      "bookCount": 30,
      "lastUpdated": "2024-12-10T00:00:00Z",
      "url": "https://nytimes.com/books/best-sellers"
    }
  ]
}
```

**æ–°å¢æ•°æ®è¡¨**:
```sql
CREATE TABLE external_rankings (
  id VARCHAR(100) PRIMARY KEY,
  source VARCHAR(50) NOT NULL,           -- amazon, nyt, goodreads, etc.
  source_name VARCHAR(100) NOT NULL,
  source_logo_url TEXT,
  title VARCHAR(200) NOT NULL,
  subtitle VARCHAR(200),
  description TEXT,
  book_type VARCHAR(20) DEFAULT 'ebook', -- ebook or magazine
  book_count INT DEFAULT 0,
  external_url TEXT,
  is_active BOOLEAN DEFAULT true,
  display_order INT DEFAULT 0,
  last_updated TIMESTAMP,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- å¤–éƒ¨æ’è¡Œæ¦œä¸­çš„ä¹¦ç±å…³è”
CREATE TABLE external_ranking_books (
  id SERIAL PRIMARY KEY,
  ranking_id VARCHAR(100) REFERENCES external_rankings(id),
  book_type VARCHAR(20) NOT NULL,       -- ebook or magazine
  book_id INT,                          -- å…³è”åˆ° ebooks æˆ– magazines è¡¨
  external_book_id VARCHAR(100),        -- å¤–éƒ¨ç³»ç»Ÿçš„ä¹¦ç±ID
  rank_position INT,                    -- åœ¨è¯¥æ¦œå•ä¸­çš„æ’å
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  UNIQUE(ranking_id, book_type, book_id)
);
```

**ç®¡ç†åå°éœ€æ±‚**:
- éœ€è¦æä¾›ç®¡ç†ç•Œé¢é…ç½®å¤–éƒ¨æ’è¡Œæ¦œ
- æˆ–ä½¿ç”¨å®šæ—¶ä»»åŠ¡è‡ªåŠ¨æŠ“å–æ›´æ–°

---

## 3. API è®¾è®¡æ€»ç»“

### 3.1 æ–°å¢ API åˆ—è¡¨

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ | ä¼˜å…ˆçº§ |
|------|------|------|--------|
| `/api/store/books-by-year` | GET | æŒ‰å¹´ä»½è·å–ä¹¦ç± | ğŸ”´ é«˜ |
| `/api/store/top-rated` | GET | è·å–é«˜è¯„åˆ†ä¹¦ç± | ğŸ”´ é«˜ |
| `/api/store/external-rankings` | GET | è·å–å¤–éƒ¨æ’è¡Œæ¦œ | ğŸŸ¡ ä¸­ |
| `/api/store/external-rankings/:id` | GET | è·å–æ’è¡Œæ¦œè¯¦æƒ…åŠä¹¦ç± | ğŸŸ¡ ä¸­ |

### 3.2 éœ€è¦ä¼˜åŒ–çš„ç°æœ‰ API

| ç«¯ç‚¹ | ä¼˜åŒ–å†…å®¹ |
|------|---------|
| `GET /api/book-lists` | å¢åŠ  `backgroundUrl`, `themeColor`, `previewCovers` å­—æ®µ |
| `GET /api/rankings/top_rated` | ç¡®ä¿è¿”å› `rating`, `ratingCount` å­—æ®µ |

### 3.3 æ–°å¢è·¯ç”±æ–‡ä»¶

å»ºè®®åˆ›å»º `/api/store.ts` ç»Ÿä¸€ç®¡ç†ä¹¦åŸé¦–é¡µç›¸å…³ APIï¼š

```typescript
// packages/api/src/routes/store.ts

import { OpenAPIHono } from '@hono/zod-openapi'

const app = new OpenAPIHono()

// GET /api/store/books-by-year
// GET /api/store/top-rated
// GET /api/store/external-rankings
// GET /api/store/home (èšåˆé¦–é¡µæ‰€æœ‰æ•°æ®çš„ä¾¿æ·æ¥å£)

export default app
```

---

## 4. æ•°æ®åº“å˜æ›´æ±‡æ€»

### 4.1 ä¿®æ”¹ç°æœ‰è¡¨

```sql
-- book_lists è¡¨å¢åŠ å­—æ®µ
ALTER TABLE book_lists ADD COLUMN background_url TEXT;
ALTER TABLE book_lists ADD COLUMN theme_color VARCHAR(20);
```

### 4.2 æ–°å¢è¡¨

```sql
-- å¤–éƒ¨æ’è¡Œæ¦œé…ç½®è¡¨
CREATE TABLE external_rankings (
  id VARCHAR(100) PRIMARY KEY,
  source VARCHAR(50) NOT NULL,
  source_name VARCHAR(100) NOT NULL,
  source_logo_url TEXT,
  title VARCHAR(200) NOT NULL,
  subtitle VARCHAR(200),
  description TEXT,
  book_type VARCHAR(20) DEFAULT 'ebook',
  book_count INT DEFAULT 0,
  external_url TEXT,
  is_active BOOLEAN DEFAULT true,
  display_order INT DEFAULT 0,
  last_updated TIMESTAMP,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- å¤–éƒ¨æ’è¡Œæ¦œä¹¦ç±å…³è”è¡¨
CREATE TABLE external_ranking_books (
  id SERIAL PRIMARY KEY,
  ranking_id VARCHAR(100) REFERENCES external_rankings(id) ON DELETE CASCADE,
  book_type VARCHAR(20) NOT NULL,
  book_id INT,
  external_book_id VARCHAR(100),
  rank_position INT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  UNIQUE(ranking_id, book_type, book_id)
);

-- ç´¢å¼•
CREATE INDEX idx_external_rankings_book_type ON external_rankings(book_type);
CREATE INDEX idx_external_rankings_active ON external_rankings(is_active);
CREATE INDEX idx_external_ranking_books_ranking ON external_ranking_books(ranking_id);
```

---

## 5. å®ç°ä¼˜å…ˆçº§

### Phase 1 - å‰ç«¯å¸ƒå±€è°ƒæ•´ (æ— éœ€åç«¯)
- [ ] æœç´¢æ ä½ç½®è°ƒæ•´ (Tab ä¸‹æ–¹ â†’ Tab ä¸Šæ–¹)
- [ ] Recommended for You æ”¹ä¸ºæ¨ªå‘æ»šåŠ¨
- [ ] Categories æ”¹ä¸ºæ¨ªå‘æ»šåŠ¨

### Phase 2 - é«˜ä¼˜å…ˆçº§åŠŸèƒ½ (éœ€è¦åç«¯)
- [ ] Books by Year åŒºå—
  - [ ] BE: æ–°å¢ `/api/store/books-by-year` API
  - [ ] FE: å®ç° `BooksByYearSection` ç»„ä»¶
- [ ] Top Rated åŒºå—
  - [ ] BE: æ–°å¢ `/api/store/top-rated` API æˆ–ä¼˜åŒ– rankings API
  - [ ] FE: å®ç° `TopRatedSection` ç»„ä»¶

### Phase 3 - ä¸­ä¼˜å…ˆçº§åŠŸèƒ½
- [ ] Curated Collections æ ·å¼ä¼˜åŒ–
  - [ ] BE: book_lists è¡¨å¢åŠ å­—æ®µ
  - [ ] BE: æ›´æ–° API è¿”å›æ–°å­—æ®µ
  - [ ] FE: é‡æ„ `CuratedCollectionsSection` ç»„ä»¶
- [ ] External Rankings åŒºå—
  - [ ] BE: æ–°å»ºæ•°æ®è¡¨
  - [ ] BE: æ–°å¢ API
  - [ ] BE: ç®¡ç†åå°é…ç½®ç•Œé¢ (å¯é€‰)
  - [ ] FE: å®ç° `ExternalRankingsSection` ç»„ä»¶

---

## 6. å¼€æ”¾é—®é¢˜

### Q1: External Rankings æ•°æ®æ¥æº
- **é€‰é¡¹ A**: æ‰‹åŠ¨é…ç½® (ç®¡ç†åå°å½•å…¥)
- **é€‰é¡¹ B**: è‡ªåŠ¨æŠ“å– (å®šæ—¶ä»»åŠ¡)
- **é€‰é¡¹ C**: ç¬¬ä¸‰æ–¹ API å¯¹æ¥

**å»ºè®®**: Phase 1 å…ˆä½¿ç”¨æ‰‹åŠ¨é…ç½®ï¼Œåç»­æ ¹æ®éœ€æ±‚æ‰©å±•

### Q2: Books by Year å¹´ä»½èŒƒå›´
- æ˜¾ç¤ºæœ€è¿‘å‡ å¹´ï¼Ÿ(å»ºè®® 3 å¹´)
- æ˜¯å¦æ”¯æŒç”¨æˆ·é€‰æ‹©ç‰¹å®šå¹´ä»½ï¼Ÿ

### Q3: Top Rated æœ€å°è¯„åˆ†äººæ•°
- å»ºè®®è®¾ç½® `minRatingCount = 10` é¿å…å°æ ·æœ¬åå·®
- æ˜¯å¦éœ€è¦å‰ç«¯å¯é…ç½®ï¼Ÿ

---

## é™„å½•: è®¾è®¡ç¨¿æˆªå›¾

### screen.png
å±•ç¤º: Recommended â†’ Categories â†’ Books by Year â†’ External Rankings

### screen copy.png
å±•ç¤º: Recommended â†’ Categories â†’ Books by Year â†’ Top Rated â†’ Curated Collections

ä¸¤ç§å¸ƒå±€å¯åŒæ—¶å®ç°ï¼Œæ ¹æ®æ•°æ®å¯ç”¨æ€§åŠ¨æ€æ˜¾ç¤ºã€‚

---

*æ–‡æ¡£ç‰ˆæœ¬: v1.0*
*åˆ›å»ºæ—¥æœŸ: 2024-12-14*
*å¾…è¯„å®¡*
