{"openapi":"3.1.0","info":{"title":"BookPost API","version":"2.0.0","description":"API for BookPost - Personal Content Library"},"servers":[{"url":"http://localhost:3001","description":"Development"},{"url":"https://bookpost-api.fly.dev","description":"Production"}],"components":{"schemas":{},"parameters":{}},"paths":{"/api/health":{"get":{"tags":["Health"],"summary":"Health check","responses":{"200":{"description":"Service is healthy","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string"},"timestamp":{"type":"string"},"version":{"type":"string"}},"required":["status","timestamp","version"]}}}}}}},"/api/health/detailed":{"get":{"tags":["Health"],"summary":"Detailed health check","responses":{"200":{"description":"Detailed health information","content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string"},"database":{"type":"string"},"uptime":{"type":"number"},"memory":{"type":"object","properties":{"used":{"type":"number"},"total":{"type":"number"}},"required":["used","total"]}},"required":["status","database","uptime","memory"]}}}}}}},"/api/auth/register":{"post":{"tags":["Auth"],"summary":"Register a new user","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"username":{"type":"string","minLength":2},"email":{"type":"string","format":"email"},"password":{"type":"string","minLength":6}},"required":["username","email","password"]}}}},"responses":{"201":{"description":"User registered successfully","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"object","properties":{"user":{"type":"object","properties":{"id":{"type":"number"},"username":{"type":"string"},"email":{"type":"string","format":"email"},"isAdmin":{"type":"boolean","nullable":true},"createdAt":{"type":"string","nullable":true}},"required":["id","username","email","isAdmin","createdAt"]},"accessToken":{"type":"string"},"refreshToken":{"type":"string"}},"required":["user","accessToken","refreshToken"]}},"required":["data"]}}}},"400":{"description":"Validation error or user exists","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"object","properties":{"code":{"type":"string"},"message":{"type":"string"}},"required":["code","message"]}},"required":["error"]}}}}}}},"/api/auth/login":{"post":{"tags":["Auth"],"summary":"Login with email and password","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"email":{"type":"string","format":"email"},"password":{"type":"string"}},"required":["email","password"]}}}},"responses":{"200":{"description":"Login successful","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"object","properties":{"user":{"type":"object","properties":{"id":{"type":"number"},"username":{"type":"string"},"email":{"type":"string","format":"email"},"isAdmin":{"type":"boolean","nullable":true},"createdAt":{"type":"string","nullable":true}},"required":["id","username","email","isAdmin","createdAt"]},"accessToken":{"type":"string"},"refreshToken":{"type":"string"}},"required":["user","accessToken","refreshToken"]}},"required":["data"]}}}},"401":{"description":"Invalid credentials","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"object","properties":{"code":{"type":"string"},"message":{"type":"string"}},"required":["code","message"]}},"required":["error"]}}}}}}},"/api/auth/refresh":{"post":{"tags":["Auth"],"summary":"Refresh access token","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"refreshToken":{"type":"string"}},"required":["refreshToken"]}}}},"responses":{"200":{"description":"Token refreshed","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"object","properties":{"accessToken":{"type":"string"},"refreshToken":{"type":"string"}},"required":["accessToken","refreshToken"]}},"required":["data"]}}}},"401":{"description":"Invalid refresh token","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"object","properties":{"code":{"type":"string"},"message":{"type":"string"}},"required":["code","message"]}},"required":["error"]}}}}}}},"/api/auth/me":{"get":{"tags":["Auth"],"summary":"Get current user","security":[{"Bearer":[]}],"responses":{"200":{"description":"Current user info","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"object","properties":{"id":{"type":"number"},"username":{"type":"string"},"email":{"type":"string","format":"email"},"isAdmin":{"type":"boolean","nullable":true},"createdAt":{"type":"string","nullable":true}},"required":["id","username","email","isAdmin","createdAt"]}},"required":["data"]}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"object","properties":{"code":{"type":"string"},"message":{"type":"string"}},"required":["code","message"]}},"required":["error"]}}}}}}},"/api/ebooks":{"get":{"tags":["Ebooks"],"summary":"List all ebooks","parameters":[{"schema":{"type":"number","nullable":true},"required":false,"name":"category","in":"query"},{"schema":{"type":"string"},"required":false,"name":"search","in":"query"},{"schema":{"type":"number","nullable":true,"default":50},"required":false,"name":"limit","in":"query"},{"schema":{"type":"number","nullable":true,"default":0},"required":false,"name":"offset","in":"query"}],"responses":{"200":{"description":"List of ebooks","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"number"},"categoryId":{"type":"number","nullable":true},"title":{"type":"string"},"filePath":{"type":"string","nullable":true},"fileSize":{"type":"number","nullable":true},"fileType":{"type":"string","nullable":true},"normalizedTitle":{"type":"string","nullable":true},"coverUrl":{"type":"string","nullable":true},"s3Key":{"type":"string","nullable":true},"createdAt":{"type":"string","nullable":true}},"required":["id","categoryId","title","filePath","fileSize","fileType","normalizedTitle","coverUrl","s3Key","createdAt"]}},"total":{"type":"number"}},"required":["data","total"]}}}}}}},"/api/ebooks/:id":{"get":{"tags":["Ebooks"],"summary":"Get ebook by ID","parameters":[{"schema":{"type":"number","nullable":true},"required":false,"name":"id","in":"path"}],"responses":{"200":{"description":"Ebook details","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"object","properties":{"id":{"type":"number"},"categoryId":{"type":"number","nullable":true},"title":{"type":"string"},"filePath":{"type":"string","nullable":true},"fileSize":{"type":"number","nullable":true},"fileType":{"type":"string","nullable":true},"normalizedTitle":{"type":"string","nullable":true},"coverUrl":{"type":"string","nullable":true},"s3Key":{"type":"string","nullable":true},"createdAt":{"type":"string","nullable":true}},"required":["id","categoryId","title","filePath","fileSize","fileType","normalizedTitle","coverUrl","s3Key","createdAt"]}},"required":["data"]}}}},"404":{"description":"Ebook not found","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"object","properties":{"code":{"type":"string"},"message":{"type":"string"}},"required":["code","message"]}},"required":["error"]}}}}}}},"/api/ebooks/categories":{"get":{"tags":["Ebooks"],"summary":"List ebook categories","responses":{"200":{"description":"List of categories","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"number"},"name":{"type":"string"},"description":{"type":"string","nullable":true},"count":{"type":"number"}},"required":["id","name","description"]}}},"required":["data"]}}}}}}},"/api/magazines":{"get":{"tags":["Magazines"],"summary":"List all magazines","parameters":[{"schema":{"type":"number","nullable":true},"required":false,"name":"publisher","in":"query"},{"schema":{"type":"number","nullable":true},"required":false,"name":"year","in":"query"},{"schema":{"type":"string"},"required":false,"name":"search","in":"query"},{"schema":{"type":"number","nullable":true,"default":50},"required":false,"name":"limit","in":"query"},{"schema":{"type":"number","nullable":true,"default":0},"required":false,"name":"offset","in":"query"}],"responses":{"200":{"description":"List of magazines","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"number"},"publisherId":{"type":"number","nullable":true},"title":{"type":"string"},"filePath":{"type":"string","nullable":true},"fileSize":{"type":"number","nullable":true},"year":{"type":"number","nullable":true},"pageCount":{"type":"number","nullable":true},"coverUrl":{"type":"string","nullable":true},"preprocessed":{"type":"boolean","nullable":true},"s3Key":{"type":"string","nullable":true},"createdAt":{"type":"string","nullable":true}},"required":["id","publisherId","title","filePath","fileSize","year","pageCount","coverUrl","preprocessed","s3Key","createdAt"]}},"total":{"type":"number"}},"required":["data","total"]}}}}}}},"/api/magazines/:id":{"get":{"tags":["Magazines"],"summary":"Get magazine by ID","parameters":[{"schema":{"type":"number","nullable":true},"required":false,"name":"id","in":"path"}],"responses":{"200":{"description":"Magazine details","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"object","properties":{"id":{"type":"number"},"publisherId":{"type":"number","nullable":true},"title":{"type":"string"},"filePath":{"type":"string","nullable":true},"fileSize":{"type":"number","nullable":true},"year":{"type":"number","nullable":true},"pageCount":{"type":"number","nullable":true},"coverUrl":{"type":"string","nullable":true},"preprocessed":{"type":"boolean","nullable":true},"s3Key":{"type":"string","nullable":true},"createdAt":{"type":"string","nullable":true}},"required":["id","publisherId","title","filePath","fileSize","year","pageCount","coverUrl","preprocessed","s3Key","createdAt"]}},"required":["data"]}}}},"404":{"description":"Magazine not found","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"object","properties":{"code":{"type":"string"},"message":{"type":"string"}},"required":["code","message"]}},"required":["error"]}}}}}}},"/api/magazines/publishers":{"get":{"tags":["Magazines"],"summary":"List magazine publishers","responses":{"200":{"description":"List of publishers","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"number"},"name":{"type":"string"},"description":{"type":"string","nullable":true},"magazineCount":{"type":"number"}},"required":["id","name","description"]}}},"required":["data"]}}}}}}},"/api/ebook-categories":{"get":{"tags":["Categories"],"summary":"List all ebook categories","responses":{"200":{"description":"List of ebook categories","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"number"},"name":{"type":"string"},"description":{"type":"string","nullable":true},"createdAt":{"type":"string","nullable":true}},"required":["id","name","description","createdAt"]}}},"required":["data"]}}}}}}},"/api/reading-history":{"get":{"tags":["Reading History"],"summary":"Get reading history for current user","parameters":[{"name":"limit","in":"query","schema":{"type":"integer","default":20}}],"responses":{"200":{"description":"Reading history entries","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"number"},"userId":{"type":"number","nullable":true},"itemType":{"type":"string"},"itemId":{"type":"number"},"title":{"type":"string","nullable":true},"coverUrl":{"type":"string","nullable":true},"lastPage":{"type":"number","nullable":true},"lastReadAt":{"type":"string","nullable":true},"createdAt":{"type":"string","nullable":true}},"required":["id","userId","itemType","itemId","title","coverUrl","lastPage","lastReadAt","createdAt"]}}},"required":["data"]}}}}}},"post":{"tags":["Reading History"],"summary":"Update reading history","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"itemType":{"type":"string","enum":["ebook","magazine","book"]},"itemId":{"type":"number"},"title":{"type":"string"},"coverUrl":{"type":"string"},"lastPage":{"type":"number"}},"required":["itemType","itemId"]}}}},"responses":{"200":{"description":"History entry updated","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"number"},"userId":{"type":"number","nullable":true},"itemType":{"type":"string"},"itemId":{"type":"number"},"title":{"type":"string","nullable":true},"coverUrl":{"type":"string","nullable":true},"lastPage":{"type":"number","nullable":true},"lastReadAt":{"type":"string","nullable":true},"createdAt":{"type":"string","nullable":true}},"required":["id","userId","itemType","itemId","title","coverUrl","lastPage","lastReadAt","createdAt"]}}}}}}}}}